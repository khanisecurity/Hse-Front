@using System.Globalization
@inject IJSRuntime JS
@inject NavigationManager Navigation

<div class="dropdown ms-1 topbar-head-dropdown header-item">
    <button type="button" class="btn btn-icon btn-topbar btn-ghost-secondary rounded-circle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <img id="header-lang-img" src="/images/flags/us.svg" alt="Header Language" height="20" class="rounded">
    </button>
    <div class="dropdown-menu dropdown-menu-end">

        <!-- item-->
        <a href="javascript:void(0);" class="dropdown-item notify-item language py-2" data-lang="en" title="English">
            <img src="/images/flags/us.svg" alt="user-image" class="me-2 rounded" height="18">
            <span class="align-middle">English</span>
        </a>

        <!-- item-->
        <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="sp" title="Spanish">
            <img src="/images/flags/spain.svg" alt="user-image" class="me-2 rounded" height="18">
            <span class="align-middle">Española</span>
        </a>

        <!-- item-->
        <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="gr" title="German">
            <img src="/images/flags/germany.svg" alt="user-image" class="me-2 rounded" height="18">
            <span class="align-middle">Deutsche</span>
        </a>

        <!-- item-->
        <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="it" title="Italian">
            <img src="/images/flags/italy.svg" alt="user-image" class="me-2 rounded" height="18">
            <span class="align-middle">Italiana</span>
        </a>

        <!-- item-->
        <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="ru" title="Russian">
            <img src="/images/flags/russia.svg" alt="user-image" class="me-2 rounded" height="18">
            <span class="align-middle">русский</span>
        </a>

        <!-- item-->
        <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="ch" title="Chinese">
            <img src="/images/flags/china.svg" alt="user-image" class="me-2 rounded" height="18">
            <span class="align-middle">中国人</span>
        </a>

        <!-- item-->
        <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="fr" title="French">
            <img src="/images/flags/french.svg" alt="user-image" class="me-2 rounded" height="18">
            <span class="align-middle">français</span>
        </a>

        <!-- item-->
        <a class="dropdown-item notify-item language" data-lang="ar" title="Arabic" @onclick='() => ChangeLanguage("ar-SA")'>
            <img src="/images/flags/ae.svg" alt="user-image" class="me-2 rounded" height="18">
            <span class="align-middle">Arabic</span>
        </a>

        <!-- item-->
        <a class="dropdown-item notify-item language" data-lang="fa" title="Farsi" @onclick='() => ChangeLanguage("fa-IR")'>
            <img src="/images/flags/ir.svg" alt="user-image" class="me-2 rounded" height="18">
            <span class="align-middle">Farsi</span>
        </a>

    </div>
</div>

@code {
    private CultureInfo? SelectedCulture;
    protected override void OnInitialized()
    {
        SelectedCulture = CultureInfo.CurrentCulture;
    }

    private void ChangeLanguage(string culture)
    {
        if (CultureInfo.CurrentCulture.EnglishName != culture)
        {
            JS.InvokeVoidAsync("blazorCulture.set", culture);
            Navigation.NavigateTo(Navigation.Uri, forceLoad: true);
        }
    }
}
